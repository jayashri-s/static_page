import{J as m,K as i,L as c,M as p,a as $,N as g,O as f}from"./DlxftPui.js";const y=m(async(t,x)=>{let s,r;if(i(t.meta,"auth")&&c(t,"auth",!1)||!p(t,[]).length)return;const e=$(),{login:n,callback:u}=e.$auth.options.redirect,h=i(t.meta,"auth")&&c(t,"auth","guest"),o=a=>f(t.path)===f(a);if(e.$auth.$state.loggedIn){const{tokenExpired:a,refreshTokenExpired:l,isRefreshable:d}=e.$auth.check(!0);if(l)e.$auth.reset();else if(a)if(d)try{[s,r]=g(()=>e.$auth.refreshTokens()),await s,r()}catch{e.$auth.reset()}else e.$auth.reset();if(!n||o(n)||h)return e.$auth.redirect("home",t)}else if(!h&&(!u||!o(u)))return e.$auth.redirect("login",t)});export{y as default};
